<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', path='css/index.css') }}" type="text/css">
</head>
<body>
<div class="wrapper mb-5">
        <div class="row main-content d-flex justify-content-center">
            <h1 class="d-flex justify-content-center col-12 mb-3 mt-5">File analyser</h1>
            <p class="d-flex justify-content-center col-9 mt-3">This is the project for subject BIT at FIIT STU in Bratislava. Aim of this website is to analyse
            potentially malicious documents and give user information about the analysed file. To use this webpage, simply import a file and wait for the output.</p>
        </div>
        <div class="d-flex justify-content-center m-5">
            <form action="/upload" method="post" enctype="multipart/form-data">
                <input class="form-control form-control-lg col-12" type="file" name="pdf_file">
                <input class="form-control form-control-lg mt-3 upload" type="submit" value="Upload">
            </form>
        </div>

        {% if message %}
        <div id="alert" class="alert justify-content-center d-flex alert-{{ "success" if "successfully" in message else "danger" }}">
            <p class="m-0 p-0 fw-bold"> {{ message }}</p>
        </div>
        {% endif %}

        {% if message %}
            {% if "success" in message %}
            <div id="output" class="row output d-flex justify-content-center m-0 mb-5 p-0 border rounded w-100 h-100">
            </div>
            {% endif %}
            {% if javascript_code_list %}
            <div class="vuln-div row d-flex mb-3 gap-3">
                {% for javascript_code in javascript_code_list %}
                    <div class="row output d-flex text-align-left justify-content-left m-0 p-0 border rounded">
                        <pre class="vulnerabilities text-align-left d-flex p-0 ms-2 pt-3 col-12">{{ javascript_code }}</pre>
                    </div>
                {% endfor %}
            </div>
            {% endif %}
        {% endif %}
</div>
<script>
    // Function to create and append <p> elements for each property

    const json = {{ content | safe }};
    function createParagraphs() {
        const outputContainer = document.getElementById('output');

        console.log(outputContainer)

        // Iterate through the properties of the JSON object
        for (const key in json) {
            if (json.hasOwnProperty(key)) {
                const p = document.createElement('p');
                p.className = 'output-text col-12';
                p.textContent = `${key}: ${json[key]}`;
                outputContainer.appendChild(p);
            }
        }
    }

    // Call the function to create and append <p> elements
    createParagraphs();

</script>

</body>
</html>